# HLR-0001 — System Initialization and Mode Control

## Rationale
Ensure the software initializes deterministically and transitions only through approved modes to prevent unsafe states in DAL A operation.

## Statement
Upon application of stable power and valid reset, the software shall complete initialization and enter **STANDBY** mode within **1.0 s**, then allow transitions only among {STANDBY, OPERATE, MAINTENANCE, FAILSAFE} according to validated commands and interlocks. Any detected critical fault shall force transition to **FAILSAFE** within **50 ms** and inhibit return to OPERATE until fault clearance is verified.

## Constraints
- Timing: init ≤ 1.0 s; fault-to-FAILSAFE ≤ 50 ms.
- Power: operates for Vin ∈ [18, 32] VDC; brownout resets to STANDBY.
- State model: no skipped states; no circular transitions without exit conditions.
- Safety: partition assumptions per IMA; latent fault handling per ARP4761 safety analysis.
- Persistence: no nonvolatile writes during initialization.

## Verification
Type: Test + Analysis + Review  
Tests:
- TST-S0001: Initialization time and entry to STANDBY.
- TST-S0002: Valid mode transitions per command table.
- TST-S0003: Fault injection leads to FAILSAFE ≤ 50 ms.
- TST-S0004: Inhibit return to OPERATE until fault cleared.

Coverage target: Statement, Decision, MC/DC = 100% at item level.

## Interfaces
- Inputs: PWR_GOOD (bool), RST_N (bool), CMD_MODE (enum), FAULT_CRIT (bool)
- Outputs: MODE (enum), STATUS (bitfield), EVENT_LOG (queue)
## Links
Parent: [SYS-010 — Aircraft Function Mode Management](../../requirements/high/SYS-010.md)

Safety: [ARP4761-HAZ-012 — Uncommanded Mode](../../constraints/ARP4761-HAZ-012.md)

Children:
- [LLR-0101 — Init Sequence](../LLR/LLR-0101.md)
- [LLR-0102 — Mode Transition Table](../LLR/LLR-0102.md)
- [LLR-0103 — Failsafe Handler](../LLR/LLR-0103.md)

Design: [DES-001 — State Machine Architecture](../../design/DES-001.md)

Code:
- [`src/mode_ctrl.c`](../../source/src/mode_ctrl.c)
- [`src/init.c`](../../source/src/init.c)

Tests:
- [TST-S0001 — Init to STANDBY](../../verification/procedures/TST-S0001.md)
- [TST-S0002 — Valid Mode Transitions](../../verification/procedures/TST-S0002.md)
- [TST-S0003 — Fault → FAILSAFE ≤50 ms](../../verification/procedures/TST-S0003.md)
- [TST-S0004 — Inhibit Return to OPERATE](../../verification/procedures/TST-S0004.md)


## Assumptions
- Clock source stable within 10 ms post power good.
- Command authentication provided by upstream function.

## Acceptance Criteria
- All tests pass over environmental extremes.
- No undefined or orphan states reachable in state coverage.
- Independence review completed and approved.
